<!DOCTYPE html>
<html>
  <head>
    <title>My App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="app.min.css">
    <link rel="stylesheet" href="./css/w3.css">
    <link rel="stylesheet" href="./css/w3-theme-indigo.css">
    <link rel="stylesheet" href="./css/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      body
  {
    background-color: #d1e6ee;
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25' height='100%25' viewBox='0 0 1200 800'%3E%3Cdefs%3E%3CradialGradient id='a' cx='0' cy='800' r='800' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23c7edff'/%3E%3Cstop offset='1' stop-color='%23c7edff' stop-opacity='0'/%3E%3C/radialGradient%3E%3CradialGradient id='b' cx='1200' cy='800' r='800' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23c9d4dd'/%3E%3Cstop offset='1' stop-color='%23c9d4ff' stop-opacity='0'/%3E%3C/radialGradient%3E%3CradialGradient id='c' cx='600' cy='0' r='600' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23c0daff'/%3E%3Cstop offset='1' stop-color='%23c0daff' stop-opacity='0'/%3E%3C/radialGradient%3E%3CradialGradient id='d' cx='600' cy='800' r='600' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23d1e6ff'/%3E%3Cstop offset='1' stop-color='%23d1e6ff' stop-opacity='0'/%3E%3C/radialGradient%3E%3CradialGradient id='e' cx='0' cy='0' r='800' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23bdf8ff'/%3E%3Cstop offset='1' stop-color='%23bdf8ff' stop-opacity='0'/%3E%3C/radialGradient%3E%3CradialGradient id='f' cx='1200' cy='0' r='800' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23c5c2ff'/%3E%3Cstop offset='1' stop-color='%23c5c2ff' stop-opacity='0'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect fill='url(%23a)' width='1200' height='800'/%3E%3Crect fill='url(%23b)' width='1200' height='800'/%3E%3Crect fill='url(%23c)' width='1200' height='800'/%3E%3Crect fill='url(%23d)' width='1200' height='800'/%3E%3Crect fill='url(%23e)' width='1200' height='800'/%3E%3Crect fill='url(%23f)' width='1200' height='800'/%3E%3C/svg%3E");
background-attachment: fixed;
background-size: cover;
background-position: center;
  }
    </style>
  </head>

  <body>
    <div class="app-page" data-page="home">
      <div class="app-topbar w3-theme-d1">
        <div class="app-title w3-center">SOLIBINS</div>
      </div>
      <div class="app-content w3-theme-l5">

        <div class="w3-row-padding" style="">
          <br><br>
          <p>
                                        <div class="w3-col s4 w3-left">Nb. tirages </div>
                                        <button class="w3-col s2 w3-theme-l4 w3-margin-right w3-round-large w3-riffle w3-center" style="width: 30px; padding-right: 3px; padding-left: 3px;" onclick="decrementNbTirages();"><b>-</b></button>
                                        <span class="w3-col s4" id="nbTiragesText">5 tirages</span>
                                        <button class="w3-col s2 w3-theme-l4 w3-margin-right w3-round-large w3-riffle w3-center" style="width: 30px; padding-right: 3px; padding-left: 3px;" onclick="incrementNbTirages();"><b>+</b></button>

            </p>
            <br>
                                        
        </div>

        <div class="w3-row-padding" style="">
          <br><br>
          <p>
                                        <div class="w3-col s4 w3-left">Chrono </div>
                                        <button class="w3-col s2 w3-theme-l4 w3-margin-right w3-round-large w3-riffle w3-center" style="width: 30px; padding-right: 3px; padding-left: 3px;" onclick="YesOrNoChrono();"><b>-</b></button>
                                        <span class="w3-col s4" id="YesOrNoChronoText">Non</span>
                                        <button class="w3-col s2 w3-theme-l4 w3-margin-right w3-round-large w3-riffle w3-center" style="width: 30px; padding-right: 3px; padding-left: 3px;" onclick="YesOrNoChrono();"><b>+</b></button>

            </p>
            <br>
                                        
        </div>

        <div class="app-section">
          <div class="app-button blue" data-target="lettres4">4 LETTRES</div>
        </div>

        <div class="app-section">
          <div class="app-button blue" data-target="lettres5">5 LETTRES</div>
        </div>

        <div class="app-section">
          <div class="app-button blue" data-target="lettres6">6 LETTRES</div>
        </div>

        <div class="app-section">
          <div class="app-button w3-blue" data-target="lettres7">7 LETTRES</div>
        </div>

        <div class="app-section">
          <div class="app-button w3-blue" data-target="lettres8">8 LETTRES</div>
        </div>
      </div>
    </div>

    <div class="app-page" data-page="lettres4">
      <div class="app-topbar">
        <div class="app-button left" data-back></div>
        <div class="app-title"><em id="title4txt">4 lettres</em></div>
      </div>
      <div class="app-content">
       <ul class="tirages app-list">
          <li class="tirage" style="vertical-align: middle; letter-spacing: 1.35pt;">
            <span class="tir left">
            </span>
            <span class="essai right w3-text-green">
            </span>
          </li>
      </ul>

      <div class="w3-display-bottommiddle" style="position: fixed; bottom: 2px;">
          <div class="app-button w3-theme w3-padding" style="width: 100%;" data-target="correction">CORRIGER</div>
      </div>
      </div>
    </div>

    <div class="app-page" data-page="lettres5">
      <div class="app-topbar">
        <div class="app-button left" data-back></div>
        <div class="app-title"><em id="title5txt">5 lettres</em></div>
      </div>
      <div class="app-content">
        <ul class="tirages app-list">
          <li class="tirage" style="vertical-align: middle; letter-spacing: 1.35pt;">
            <span class="tir left">
            </span>
            <span class="essai right w3-text-green">
            </span>
          </li>
      </ul>

      <div class="w3-display-bottommiddle" style="position: fixed; bottom: 2px;">
          <div class="app-button w3-theme w3-padding" style="width: 100%;" data-target="correction">CORRIGER</div>
      </div>
      </div>
    </div>

    <div class="app-page" data-page="lettres6">
      <div class="app-topbar">
        <div class="app-button left" data-back></div>
        <div class="app-title"><em id="title6txt">6 lettres</em></div>
      </div>
      <div class="app-content">
        <ul class="tirages app-list">
          <li class="tirage" style="vertical-align: middle; letter-spacing: 1.35pt;">
            <span class="tir left">
            </span>
            <span class="essai right w3-text-green">
            </span>
          </li>
      </ul>

      <div class="w3-display-bottommiddle" style="position: fixed; bottom: 2px;">
          <div class="app-button w3-theme w3-padding" style="width: 100%;" data-target="correction">CORRIGER</div>
      </div>
      </div>
    </div>

    <div class="app-page" data-page="lettres7">
      <div class="app-topbar">
        <div class="app-button left" data-back></div>
        <div class="app-title"><em id="title7txt">7 lettres</em></div>
      </div>
      <div class="app-content">
      <ul class="tirages app-list">
          <li class="tirage" style="vertical-align: middle; letter-spacing: 1.35pt;">
            <div class="w3-row-padding">
              <div class="tir w3-third">
              </div>
              <div class="essai right w3-third">
            </div>
            </div>
            
            
          </li>
      </ul>

      <div class="w3-display-bottommiddle" style="position: fixed; bottom: 2px;">
          <div class="app-button w3-theme w3-padding" style="width: 100%;" data-target="correction">CORRIGER</div>
      </div>
    </div>
    </div>

    <div class="app-page" data-page="lettres8">
      <div class="app-topbar">
        <div class="app-button left" data-back></div>
        <div class="app-title"><em id="title8txt">8 lettres</em></div>
      </div>
      <div class="app-content">
        <ul class="tirages app-list">
          <li class="tirage" style="vertical-align: middle; letter-spacing: 1.35pt;">
            <span class="tir left">
            </span>
            <span class="essai right w3-text-green">
            </span>
          </li>
      </ul>

      <div class="w3-display-bottommiddle" style="position: fixed; bottom: 2px;">
          <div class="app-button w3-theme w3-padding" style="width: 100%;" data-target="correction">CORRIGER</div>
      </div>
      </div>
    </div>

    <div class="app-page" data-page="proposition">
      <div class="app-content  w3-light-blue">
        <div class="app-topbar">
            <div class="app-button left w3-black" data-target="lettres7"></div>
           <div class="app-title"><em>Proposition</em></div>
        </div>
        <br><br>
        <div class="w3-right w3-margin-right">Tirage nÂ° <span id="numTirageActuel"></span> / <span id="numTiragesTotal"></span></div>
          <br><br>
          <div class="espaceTirage w3-center">
            
          </div>
          <br><br>
          <div class="espacePropo w3-center">
            
          </div>

          <br><br>
          <div class="app-button w3-center w3-theme-l1 w3-ripple" id="passerOuValiderBtn" style="width:40%;">Passer</div>

      </div>
    </div>

    <div class="app-page" data-page="correction">
      <div class="app-content  w3-light-blue">
        <div class="app-topbar">
        <div class="app-button w3-black" onclick="location.reload();">Accueil</div>
        <div class="w3-center" style="margin: 0 auto;"><b>Solution</b></div>
      </div>
        <br><br>

        <div class="solutionstirages app-section">
          <div class="solutiontirage w3-container" style="vertical-align: middle; letter-spacing: 1pt;">
            <div class="w3-row-padding">
                <div class="tirpoursol w3-col s4 w3-left">
                </div>

                <div class="propotir w3-col s4">
                </div>

                <div class="soltir w3-col s4 w3-text-green w3-right">
                </div>
            </div>
            
            
          </div>

          
      </div>
        <br><br><br>
               <div class="app-content w3-theme-l2 w3-padding">
                   <div class="w3-large w3-round-large w3-center" style="display: block;" id="scoreDiv">Votre score: <span class="w3-xxlarge w3-text-green w3-light-blue w3-padding w3-round-large" id="scoreExo" style="font-weight: 900;"></span></div>
               </div>

      </div>
    </div>

    <script src="zepto.js"></script>
    <script src="app.min.js"></script>
    <script src="solibin4.js"></script>
    <script src="solibin5.js"></script>
    <script src="solibin6.js"></script>
    <script src="solibin7.js"></script>
    <script src="solibin8.js"></script>

    <script>
      App.controller('home', function (page) {
        
      });

      App.controller('lettres4', function (page) {
        TABSESSION = shuffle(soliBinTab(4)).slice(0, NBTIRAGES);
        var l = 4;
        var stringL = l + " lettres - " + NBTIRAGES + " tirages";
        $(page).find('#title4txt').text(stringL);

        var $template = $(page).find('.tirage').remove();
          var $tirages = $(page).find('.tirages');
         TABSESSION.forEach(function (tirage, i, arr) {
            var $tirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $tirage.find('.tir').html("<h4><b>" + affich + "</b></h4>");
            else
              $tirage.find('.tir').html("<h4>" + affich + "</h4>");

            $tirage.on('click', function (){
               App.load('proposition', {tirage: affich, num:i});
            });
            $tirages.append($tirage);
         });
      });

      App.controller('lettres5', function (page) {
        TABSESSION = shuffle(soliBinTab(5)).slice(0, NBTIRAGES);
        var l = 5;
        var stringL = l + " lettres - " + NBTIRAGES + " tirages";
        $(page).find('#title5txt').text(stringL);

        var $template = $(page).find('.tirage').remove();
          var $tirages = $(page).find('.tirages');
         TABSESSION.forEach(function (tirage, i, arr) {
            var $tirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $tirage.find('.tir').html("<h4><b>" + affich + "</b></h4>");
            else
              $tirage.find('.tir').html("<h4>" + affich + "</h4>");

           $tirage.on('click', function (){
               App.load('proposition', {tirage: affich, num:i});
            });

            $tirages.append($tirage);
         });
      });

      App.controller('lettres6', function (page) {
        TABSESSION = shuffle(soliBinTab(6)).slice(0, NBTIRAGES);
        var l = 6;
        var stringL = l + " lettres - " + NBTIRAGES + " tirages";
        $(page).find('#title6txt').text(stringL);

        var $template = $(page).find('.tirage').remove();
          var $tirages = $(page).find('.tirages');
         TABSESSION.forEach(function (tirage, i, arr) {
            var $tirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $tirage.find('.tir').html("<h4><b>" + affich + "</b></h4>");
            else
              $tirage.find('.tir').html("<h4>" + affich + "</h4>");

            $tirage.on('click', function (){
               App.load('proposition', {tirage: affich, num:i});
            });

            $tirages.append($tirage);
         });
      });

      App.controller('lettres7', function (page) {
        TABSESSION = shuffle(soliBinTab(7)).slice(0, NBTIRAGES);
        var l = 7;
        var stringL = l + " lettres - " + NBTIRAGES + " tirages";
        $(page).find('#title7txt').text(stringL);

        var $template = $(page).find('.tirage').remove();
          var $tirages = $(page).find('.tirages');
         TABSESSION.forEach(function (tirage, i, arr) {
            var $tirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $tirage.find('.tir').html("<h4><b>" + affich + "</b></h4>");
            else
              $tirage.find('.tir').html("<h4>" + affich + "</h4>");

            $tirage.on('click', function (){
               App.load('proposition', {tirage: affich, num:i});
            });
            $tirages.append($tirage);
         });
       });

      App.controller('lettres8', function (page) {
        TABSESSION = shuffle(soliBinTab(8)).slice(0, NBTIRAGES);;
        var l = 8;
        var stringL = l + " lettres - " + NBTIRAGES + " tirages";
        $(page).find('#title8txt').text(stringL);

        var $template = $(page).find('.tirage').remove();
          var $tirages = $(page).find('.tirages');
         TABSESSION.forEach(function (tirage, i, arr) {
            var $tirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $tirage.find('.tir').html("<h4><b>" + affich + "</b></h4>");
            else
              $tirage.find('.tir').html("<h4>" + affich + "</h4>");

            $tirage.on('click', function (){
               App.load('proposition', {tirage: affich, num:i});
            });
            $tirages.append($tirage);
         });
      });


      App.controller('proposition', function (page, data) {

        $(page).find('.espaceTirage').html(drawWord(data.tirage));
        $(page).find('#numTirageActuel').text((data.num+1));
        $(page).find('#numTiragesTotal').text(NBTIRAGES);
        $(page).find('.espacePropo' ).html(drawWord(""));

        $(page).find('#passerOuValiderBtn').on('click', function(){
                 var numActuel = data.num;
                 var nextNum = numActuel == NBTIRAGES-1 ? 0: numActuel+1;
                 var affich = TABSESSION[nextNum].hasOwnProperty("ana") ? TABSESSION[nextNum]["ana"]: TABSESSION[nextNum]["id"].split("").sort().join("");

                 App.load('proposition', {tirage: affich, num: nextNum});
        })
      });


      App.controller('correction', function (page) {

        var $template = $(page).find('.solutiontirage').remove();
        var $solutionstirages = $(page).find('.solutionstirages');

        $(page).find('#scoreExo').text("8" + " / " + TABSESSION.length);

        TABSESSION.forEach(function (tirage, i, arr) {
            var $solutiontirage = $template.clone(true);
            var affich = arr[i].hasOwnProperty("ana") ? arr[i]["ana"]: arr[i]["id"].split("").sort().join("");
            if(arr[i].hasOwnProperty("ana"))
               $solutiontirage.find('.tirpoursol').html("<span><b>" + affich + "</b></span>");
            else
              $solutiontirage.find('.tirpoursol').html("<span>" + affich + "</span>");

            var aTrouve = propoTabs[i] == TABSESSION[i]['id'];

            if(aTrouve)
              $solutiontirage.find('.propotir').html("<span>" + " = " + "</span>");
            else
            {
                $solutiontirage.find('.propotir').html("<span class='w3-text-red'><div>" + propoTabs[i] + "</s></span>");
            }

            $solutiontirage.find('.soltir').html("<div class='w3-text-green'><b>" + TABSESSION[i]["id"] + "</b></div>");
            $solutionstirages.append($solutiontirage);
         });
      });

      try {
        App.restore();
      } catch (err) {
        App.load('home');
      }
    </script>

    <script>

var NBTIRAGES = 5;
var YES_OR_NO_CHRONO = false;
var propoTabs = Array(NBTIRAGES);
propoTabs.fill("");
var TABSESSION = soliBinTab(4);


function shuffle(a) {
    var j, x, i;
    for (i = a.length - 1; i > 0; i--) {
        j = Math.floor(Math.random() * (i + 1));
        x = a[i];
        a[i] = a[j];
        a[j] = x;
    }
    return a;
}

function soliBinTab(l)
{
  if(l==4)
    return tabSoliBin4;
  if(l==5)
    return tabSoliBin5;
  if(l==6)
    return tabSoliBin6;
  if(l==7)
    return tabSoliBin7;
  if(l==8)
    return tabSoliBin8;

  return [];
}
function incrementNbTirages()
{
   if(NBTIRAGES >= 100)
      NBTIRAGES = 5;
   else
    NBTIRAGES += 5;

  propoTabs = Array(NBTIRAGES);
  propoTabs.fill("");

  document.getElementById('nbTiragesText').textContent = NBTIRAGES + " tirages";

}

function decrementNbTirages()
{
   if(NBTIRAGES <= 5)
      NBTIRAGES = 100;
   else
    NBTIRAGES -= 5;

  propoTabs = Array(NBTIRAGES);
  propoTabs.fill("");
  document.getElementById('nbTiragesText').textContent = NBTIRAGES + " tirages";

    
}

function YesOrNoChrono()
{
  YES_OR_NO_CHRONO = !YES_OR_NO_CHRONO;
  document.getElementById("YesOrNoChronoText").textContent = YES_OR_NO_CHRONO ? 'Oui':'Non';

}

function drawLetter(ltr)
{

      return `<span class='w3-bordered w3-round-medium w3-xxlarge w3-card-2' style='padding:5px; margin-right:2px; background-color:rgba(160, 250, 200, 0.8); color:black;' onclick='this.style.backgroundColor = "gray"; this.style.color="#222"'><b>${ltr}</b></span>`;
  
}

function drawWord(wd)
{
  var tab = wd.split('');
  var ch = "";
  tab.forEach(l => ch += drawLetter(l));
  return ch;
} 


    </script>
  </body>
</html>
